apply plugin: 'groovy'

repositories {
	mavenCentral()
}

dependencies {
	testCompile 'org.codehaus.geb:geb-core:0.5.1'
	testCompile 'org.codehaus.geb:geb-easyb:0.5.1'
	testCompile 'org.seleniumhq.selenium:selenium-firefox-driver:2.0b3'
	testCompile 'org.easyb:easyb:0.9.7'
}


ant {
	taskdef(name: "easyb", classname:"org.easyb.ant.BehaviorRunnerTask", 
                classpath: sourceSets.test.runtimeClasspath.asPath)
}

test.doLast {
   ant.easyb( classpath: sourceSets.test.runtimeClasspath.asPath, failureProperty:'easyb_failed' ) {
        report( location:"${project.testResultsDir}/story.txt", format:"txtstory" )
        behaviors( dir: "src/test/stories" ) {
            include( name:"**/*.story" )
        }
  }
  ant.fail( if:'easyb_failed', message: 'Failures in easyb stories' )
}
